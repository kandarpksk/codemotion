<!DOCTYPE html>
<html>
<head>
	 <meta charset="utf-8"> 
	<title>Codemotion v0</title>
</head>
<body>
	<!-- lots of options -->
	<!-- http://stackoverflow.com/questions/10004723/html5-input-type-range-show-range-value -->
	<!-- this is cool -->
	<!-- http://thecodeplayer.com/walkthrough/spicing-up-the-html5-range-slider-input -->
	<div id="slider">
		<input id="slide" type="range" min="0" max="100" value="25" onchange="updateSlider(this.value)" style="width:300px; "/>
		<span id="time" style="vertical-align:2px; font-family:sans-serif; ">0:33</span>
		<br/>
		<div style="display:inline-block; "><img id="frame1" src="resources/v2_frame62481.jpg" alt="frame" width="483px"/></div>
		<div style="display:inline-block; vertical-align:12%; "><textarea id="code1" rows="15" cols="50">{code here}</textarea></div>
		<br/>
		<div id="outputs">...</div>
	</div>
	
	<script>
		showAllSegments(62481);

		function updateSlider(val) {
			var display = document.getElementById('time');
			// display.innerHTML = (val*1913.3).toFixed(0);
			var hour = Math.floor(val*79.8/3600);
			var minute = (((val*79.8)%3600)/60).toFixed(0);
			display.innerHTML = hour+':'+minute;

			var pic = document.getElementById('frame1');
			// pic.src = '../outputs/v2_frame'+val+'.jpg';
			var f = 62481;
			if (val > 50) f = 65352;
			pic.src = 'resources/v2_frame'+f+'.jpg';
			pic.alt = 'resources/v2_frame'+val+'.jpg';

			showAllSegments(f);
		}

		function read(file) {
			var req = new XMLHttpRequest();
			req.open('GET', file, false);
			try { req.send(); } catch(e) {}
			if (req.status == 200) return req.responseText;
			else return null;
		}

		function display(f, s) { //frame, segment
			file = 'resources/v2_frame'+f+'_segment'+s+'.txt';
			var code = read(file);
			if (code != null)
				document.getElementById('code1').innerHTML = code;
		}

		function showAllSegments(frame) {
			var file = 'resources/v2_frame'+frame+'.txt';
			var text = read(file);
			var o = document.getElementById('outputs');
			if (text == null) o.innerHTML = 'No segments found.';
			else {
				o.innerHTML = '';
				var updated = false;
				for(var i = 0; i < text; i++) {
					var path = 'resources/v2_frame'+frame+'_segment'+(i+1)+'.jpg';
					if (read(path) != null) {
						o.innerHTML += '<img src="'+path+'" width="'+225+'px" onclick="display('+frame+', '+(i+1)+')"> ';
						if (!updated) { updated = true; display(frame, i+1); }
					}
				}
			}
		}
	</script>
</body>
</html>