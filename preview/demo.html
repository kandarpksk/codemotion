<!DOCTYPE html>
<html>
<head>
	 <meta charset="utf-8"> 
	<title>Codemotion v0</title>
</head>
<body>
	<!-- lots of options -->
	<!-- http://stackoverflow.com/questions/10004723/html5-input-type-range-show-range-value -->
	<!-- this is cool -->
	<!-- http://thecodeplayer.com/walkthrough/spicing-up-the-html5-range-slider-input -->
	<div id="slider">
		<input id="slide" type="range" min="1" max="7980" value="1" onchange="updateSlider(this.value)" style="width:300px; "/>
		<span id="time" style="vertical-align:2px; font-family:sans-serif; ">0:0:1 | frame #1</span>
		<br/>
		<div style="display:inline-block; "><img id="frame1" src="resources/v2_frame217.jpg" alt="frame" width="483px"/></div>
		<div style="display:inline-block; vertical-align:12%; "><textarea id="code1" rows="15" cols="50">This is CS50</textarea></div>
		<br/>
		<div id="outputs">...</div>
	</div>
	
	<script>
		showAllSegments(1);

		function updateSlider(val) {
			var display = document.getElementById('time');
			// display.innerHTML = (val*1913.3).toFixed(0);
			var hour = Math.floor(val/3600);
			var minute = Math.floor((val%3600)/60);
			var sec = val%60;
			val = (val-1)*24 + 1; //
			display.innerHTML = hour+':'+minute+':'+sec + ' | frame #' + val;
			
			var pic = document.getElementById('frame1');
			pic.src = 'resources/v2_frame'+val+'.jpg';
			pic.alt = 'resources/v2_frame'+val+'.jpg';

			showAllSegments(val);
		}

		function read(file) {
			var req = new XMLHttpRequest();
			req.open('GET', file, false);
			try { req.send(); } catch(e) {}
			if (req.status == 200) return req.responseText;
			else return null;
		}

		function display(f, s) { //frame, segment
			file = 'resources/v2_frame'+f+'_segment'+s+'.txt';
			var code = read(file);
			if (code != null)
				document.getElementById('code1').innerHTML = code;
		}

		function showAllSegments(frame) {
			var file = 'resources/v2_frame'+frame+'.txt';
			var text = read(file);
			var o = document.getElementById('outputs');
			if (text == null) {
				o.innerHTML = 'No segments found.';
				// document.getElementById('code1').innerHTML = '';
			}
			else {
				o.innerHTML = '';
				var updated = false;
				document.getElementById('code1').innerHTML = '';
				for(var i = 0; i < text; i++) { //segment0...?
					var path = 'resources/v2_frame'+frame+'_segment'+(i+1)+'.jpg';
					var img_exists;
					try { img_exists = read(path); } catch(e) {}
					if (img_exists) {
						o.innerHTML += '<img src="'+path+'" width="'+225+'px" onclick="display('+frame+', '+(i+1)+')"> ';
						if (!updated) { updated = true; display(frame, i+1); }
					}
				}
			}
		}
	</script>
</body>
</html>